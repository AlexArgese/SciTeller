@import "./tokens.css";

/* Reset leggero */
*, *::before, *::after { box-sizing: border-box; }
html, body, #root { height: 100%; }
body, h1, h2, h3, h4, p, figure { margin: 0; }
img, svg { display: block; max-width: 100%; }
button, input, select, textarea { font: inherit; color: inherit; background: transparent; border: 0; }
button { cursor: pointer; }
:focus { outline: none; }
:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }

/* Tipografia */
html { font-size: 100%; }
body {
  font-family: var(--font-sans);
  font-size: var(--fs-body);
  line-height: var(--lh-normal);
  color: var(--text);
  background: var(--bg);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
h1, h2, h3, .h1, .h2, .h3 {
  font-family: var(--font-serif);
  letter-spacing: 0.01em;
  color: var(--heading);
}
h1, .h1 { font-size: var(--fs-h1); line-height: var(--lh-tight); }
h2, .h2 { font-size: var(--fs-h2); line-height: var(--lh-snug); }
h3, .h3 { font-size: var(--fs-h3); line-height: var(--lh-snug); }
small, .small { font-size: var(--fs-small); color: var(--text-2); }

/* Carta realistica: grain + righe + filigrana */
body::before {
  content: "";
  position: fixed; inset: 0; pointer-events: none;
  background:
    radial-gradient(1200px 800px at 75% -10%, rgba(85,104,255,.10), transparent 60%),
    radial-gradient(900px 600px at -10% 20%, rgba(95,208,192,.08), transparent 60%),
    var(--line-paper-bg),
    linear-gradient(90deg, transparent 0%, rgba(255,255,255,.12) 35%, transparent 70%);
  opacity: .85;
  z-index: var(--z-base);
}
body::after{
  content:"";
  position:fixed; inset:0; pointer-events:none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160' viewBox='0 0 160 160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3CfeComponentTransfer%3E%3CfeFuncA type='table' tableValues='0 0 .015 .03 .05 .06 .06 .04 .02 0 0'/%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)'/%3E%3C/svg%3E");
  mix-blend-mode: multiply;
  opacity:.25;
  z-index: var(--z-base);
}

/* Container */
.container {
  width: var(--container-w);
  margin: calc(var(--sp-8) + var(--nav-h)) 0 var(--sp-10); /* niente auto ai lati */
  padding-left: 0;
  padding-right: 0;
}

/* Footer helper */
.appFooter { margin-top: var(--sp-10); }

/* Primitives */
.card {
  background: var(--panel);
  border: 1px solid var(--line-0);
  border-radius: var(--r-lg);
  box-shadow: var(--shadow-1);
}
.glass {
  background: var(--glass-bg);
  -webkit-backdrop-filter: blur(var(--glass-blur));
  backdrop-filter: blur(var(--glass-blur));
  border-radius: var(--r-2xl);
  box-shadow: var(--glass-sd);
  border: 1px solid var(--glass-line);
}
.chip {
  display: inline-flex; align-items: center; gap: 8px;
  border-radius: 999px; padding: 8px 12px;
  background: color-mix(in oklab, var(--panel-2) 70%, transparent);
  border: 1px solid var(--line-1);
}
.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 10px;
  height: 44px; padding: 0 18px; border-radius: 999px;
  font-weight: 600; letter-spacing: .01em;
  transition: transform var(--dur-2) var(--ease-emph), box-shadow var(--dur-2) var(--ease-emph), background var(--dur-2) var(--ease-emph);
  box-shadow: var(--shadow-1);
  background: var(--ink-0); color: #fff;
}
.btn:hover { transform: translateY(-1px); box-shadow: var(--shadow-2); }
.btn:active { transform: translateY(0); box-shadow: var(--shadow-1); }
.btn[disabled] { opacity: .6; cursor: not-allowed; }
.btn-ghost { background: transparent; color: var(--ink-0); border: 1px solid var(--line-0); box-shadow: none; }
.btn-ghost:hover { background: color-mix(in oklab, var(--panel) 65%, transparent); }
.btn-primary {
  background: var(--glass-blue-bg);
  color: #fff;
  box-shadow: var(--glass-blue-sd)
}
.btn-primary:hover { box-shadow: var(--glass-blue-sd); }

/* Inputs */
.input, input[type="text"], select, textarea {
  height: 44px; padding: 0 14px; border-radius: var(--r-md);
  border: 1px solid var(--line-0); background: var(--panel); color: var(--text);
  transition: border-color var(--dur-2) var(--ease-emph), background var(--dur-2) var(--ease-emph), box-shadow var(--dur-2) var(--ease-emph);
}
.input, input[type="url"]{
  height: 44px; padding: 27px 14px; border-radius: var(--r-md);
  border: 1px solid var(--line-0); background: var(--panel); color: var(--text);
  transition: border-color var(--dur-2) var(--ease-emph), background var(--dur-2) var(--ease-emph), box-shadow var(--dur-2) var(--ease-emph);
}
.input:focus-within, input:focus, select:focus, textarea:focus {
  border-color: color-mix(in oklab, var(--accent) 60%, var(--line-0));
  box-shadow: 0 0 0 4px color-mix(in oklab, var(--accent) 18%, transparent);
}
::placeholder { color: var(--text-2); opacity: .85; }

/* Route offset */
body[data-route="home"] .container { margin-top: calc(var(--sp-7) + var(--nav-h)); }

/* Footer (match component) */
footer.appFooter {
  width: var(--container-w);
  margin-left: auto; margin-right: auto;
  padding: var(--sp-7) 0;
  display: grid; grid-template-columns: 1fr auto auto;
  align-items: center; gap: var(--sp-6);
  color: var(--text-2);
  border-top: 1px dashed var(--line-0);
}
footer.appFooter .copy { font-size: var(--fs-small); }
footer.appFooter .gh svg path { fill: var(--ink-0); }

/* Utilities */
.center { display: grid; place-items: center; }
.mono { font-family: var(--font-mono); }
.hidden { display: none !important; }
.hr { height: 1px; width: 100%; background: linear-gradient(90deg, transparent, var(--line-0), transparent); }

/* Toast layer */
#toasts { position: fixed; right: 16px; bottom: 16px; z-index: var(--z-toast); display: grid; gap: 10px; }
body[data-route="stories"] .container {
  margin-top: 0 !important;     /* niente nav-h qui */
  padding-top: 0 !important;    /* nessun padding che introduca ritardi */
}
body[data-route="stories"] .appFooter,
body[data-route="stories"] footer.appFooter {
  margin-top: 0 !important;
}
/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  * { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; scroll-behavior: auto !important; }
}
